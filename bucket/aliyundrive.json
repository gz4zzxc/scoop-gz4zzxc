{
    "version": "6.9.1",
    "useragent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
    "description": "阿里云盘官方桌面客户端",
    "homepage": "https://www.aliyundrive.com/",
    "license": "Proprietary",
    "notes": [
        "阿里云盘官方桌面客户端",
        "支持快速上传下载、文件管理、在线预览等功能",
        "安装后可在开始菜单或桌面找到阿里云盘图标",
        "首次使用需要登录阿里云账号"
    ],
    "architecture": {
        "64bit": {
            "url": "https://cdn.jsdelivr.net/gh/gz4zzxc/scoop-gz4zzxc@main/LICENSE#/dl-bypass",
            "hash": "6B0382B16279F26FF69014300541967A356A666EB0B91B422F6862F6B7DAD17E"
        }
    },
    "pre_install": [
        "if (Test-Path \"$dir\\LICENSE\") { Remove-Item \"$dir\\LICENSE\" -Force }",
        "$downloadUrl = \"https://cdn.aliyundrive.net/downloads/apps/desktop/aDrive-$version.exe\"",
        "$outputFile = \"$dir\\aDrive-$version.exe\"",
        "$userAgent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'",
        "Invoke-WebRequest -Uri $downloadUrl -UserAgent $userAgent -OutFile $outputFile -UseBasicParsing",
        "$expectedHash = \"cc40289de6c35821214c816b8a1101c3ada822f05c7da3b770ae432067eea76a\"",
        "$actualHash = (Get-FileHash -Path $outputFile -Algorithm SHA256).Hash",
        "if ($actualHash -ne $expectedHash) { throw \"Hash mismatch! Expected: $expectedHash, Actual: $actualHash\" }",
        "& 7z x \"$outputFile\" -o\"$dir\" -y",
        "Remove-Item \"$outputFile\" -Force",
        "if (-not (Test-Path \"$dir\\aDrive.exe\")) { throw \"Extraction Failed: aDrive.exe not found\" }",
        "if (Test-Path \"$dir\\app-64.7z\") { & 7z x \"$dir\\app-64.7z\" -o\"$dir\" -y; Remove-Item \"$dir\\app-64.7z\" -Force }",
        "if (Test-Path \"$dir\\app.7z\") { & 7z x \"$dir\\app.7z\" -o\"$dir\" -y; Remove-Item \"$dir\\app.7z\" -Force }",
        "@('uninst.exe.nsis', '$PLUGINSDIR') | ForEach-Object { if (Test-Path \"$dir\\$_\") { Remove-Item \"$dir\\$_\" -Recurse -Force -ErrorAction SilentlyContinue } }"
    ],
    "bin": "aDrive.exe",
    "shortcuts": [
        [
            "aDrive.exe",
            "阿里云盘"
        ]
    ],
    "post_install": [
        "Write-Host '阿里云盘已安装完成！' -ForegroundColor Cyan",
        "Write-Host '您可以在开始菜单或桌面找到阿里云盘图标' -ForegroundColor Yellow",
        "Write-Host '首次使用请登录您的阿里云账号' -ForegroundColor Yellow",
        "# Only create desktop shortcut in PowerShell 5.1 (pwsh doesn't support COM objects)",
        "if ($PSVersionTable.PSVersion.Major -lt 6) {",
        "    $wsh = New-Object -ComObject WScript.Shell",
        "    $lnk = $wsh.CreateShortcut(\"$([Environment]::GetFolderPath('Desktop'))\\阿里云盘.lnk\")",
        "    $lnk.TargetPath = \"$dir\\aDrive.exe\"",
        "    $lnk.Save()",
        "} else {",
        "    Write-Host 'Desktop shortcut creation skipped: PowerShell 7+ detected (COM objects not supported)' -ForegroundColor DarkYellow",
        "}"
    ],
    "pre_uninstall": [
        "if (Test-Path \"$([Environment]::GetFolderPath('Desktop'))\\阿里云盘.lnk\") { Remove-Item \"$([Environment]::GetFolderPath('Desktop'))\\阿里云盘.lnk\" -Force }"
    ],
    "checkver": {
        "url": "https://www.aliyundrive.com/download",
        "regex": "aDrive-([\\d.]+)\\.exe",
        "useragent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://cdn.aliyundrive.net/downloads/apps/desktop/aDrive-$version.exe"
            }
        },
        "hash": {
            "mode": "download"
        }
    }
}